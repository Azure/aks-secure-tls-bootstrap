# syntax=ghcr.io/azure/dalec/frontend:latest

name: aks-secure-tls-bootstrap-client
version: v0.1.0-alpha.1
revision: 1
license: MIT
description: AKS secure TLS bootstrapping client

sources:
  src:
    path: client
    generate:
      - gomod: {}
    git:
      url: https://github.com/Azure/aks-secure-tls-bootstrap.git
      commit: "client/v0.1.0-alpha.4"

dependencies:
  build:
    golang:

build:
  env:
    CGO_ENABLED: "0"
  steps:
    - command: |
        cd src
        make build-client-all

artifacts:
  binaries:
    src/client/bin/tls-bootstrap-client-amd64:
    src/client/bin/tls-bootstrap-client-arm64:
    src/client/bin/tls-bootstrap-client-amd64.exe:
    src/client/bin/tls-bootstrap-client-arm64.exe:

tests:
  - name: Check bin
    files:
      /usr/bin/tls-bootstrap-client-amd64:
        permissions: 0755
      /usr/bin/tls-bootstrap-client-arm64:
        permissions: 0755